var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,k,l){c instanceof String&&(c=String(c));for(var h=c.length,r=0;r<h;r++){var t=c[r];if(k.call(l,t,r,c))return{i:r,v:t}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,k,l){c!=Array.prototype&&c!=Object.prototype&&(c[k]=l.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,k,l,h){if(k){l=$jscomp.global;c=c.split(".");for(h=0;h<c.length-1;h++){var r=c[h];r in l||(l[r]={});l=l[r]}c=c[c.length-1];h=l[c];k=k(h);k!=h&&null!=k&&$jscomp.defineProperty(l,c,{configurable:!0,writable:!0,value:k})}};$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,l){return $jscomp.findInternal(this,c,l).v}},"es6","es3");
(function(c){if("function"===typeof define&&define.amd)define(["jquery","jquery-ui","d3","JSRootPainter","JSRootPainter.hierarchy"],c);else{if("undefined"==typeof jQuery)throw Error("jQuery not defined","JSRootPainter.jquery.js");if("undefined"==typeof jQuery.ui)throw Error("jQuery-ui not defined","JSRootPainter.jquery.js");if("object"!=typeof d3)throw Error("This extension requires d3.v3.js","JSRootPainter.jquery.js");if("undefined"==typeof JSROOT)throw Error("JSROOT is not defined","JSRootPainter.jquery.js");
if("object"!=typeof JSROOT.Painter)throw Error("JSROOT.Painter not defined","JSRootPainter.jquery.js");c(jQuery,jQuery.ui,d3,JSROOT)}})(function(c,k,l,h){function r(a){h.MDIDisplay.call(this,a);this.cnt=0}function t(a){h.MDIDisplay.call(this,a);this.cnt=0}function w(a){h.MDIDisplay.call(this,a);this.cnt=0}h.sources.push("jq2d");"function"===typeof define&&define.amd&&h.loadScript("$$$style/jquery-ui.css");h.Painter.createMenu=function(a,b){b||"function"!==typeof a||(b=a,a=null);var d={painter:a,element:null,
code:"",cnt:1,funcs:{},separ:!1,add:function(a,b,d){if("separator"==a)this.code+="<li>-</li>",this.separ=!0;else if(0==a.indexOf("header:"))this.code+="<li class='ui-widget-header' style='padding:3px; padding-left:5px;'>"+a.substr(7)+"</li>";else if("endsub:"==a)this.code+="</ul></li>";else{var e="</li>";0==a.indexOf("sub:")&&(a=a.substr(4),e="<ul>");"function"==typeof b&&(d=b,b=a);var f="";0==a.indexOf("chk:")?(f="<span class='ui-icon ui-icon-check' style='margin:1px'></span>",a=a.substr(4)):0==
a.indexOf("unk:")&&(f="<span class='ui-icon ui-icon-blank' style='margin:1px'></span>",a=a.substr(4));f=0==c.ui.version.indexOf("1.10")||0==c.ui.version.indexOf("1.9")?'<a href="#">'+f+a+"</a>":0==c.ui.version.indexOf("1.11")?f+a:"<div>"+f+a+"</div>";this.code+="<li cnt='"+this.cnt+"' arg='"+b+"' style=''>"+f+e;"function"==typeof d&&(this.funcs[this.cnt]=d);this.cnt++}},addchk:function(a,b,d,c){return this.add((a?"chk:":"unk:")+b,d,c)},size:function(){return this.cnt-1},addDrawMenu:function(a,b,d){b||
(b=[]);0==b.length&&b.push("");var f=!1;0==a.indexOf("nosub:")&&(f=!0,a=a.substr(6));if(1===b.length)return"inspect"===b[0]&&(a=a.replace("Draw","Inspect")),this.add(a,b[0],d);f||this.add("sub:"+a,b[0],d);for(var e=0;e<b.length;++e){var c=b[e];""==c&&(c="&lt;dflt&gt;");var g=e+1;if(5<b.length&&0<c.length)for(;g<b.length&&0==b[g].indexOf(c);)g++;f&&(c=a+" "+c);if(g<e+2)this.add(c,b[e],d);else{this.add("sub:"+c,b[e],d);for(e+=1;e<g;++e)this.add(b[e],b[e],d);this.add("endsub:");e=g-1}}f||this.add("endsub:")},
remove:function(){null!==this.element&&(this.element.remove(),this.close_callback&&this.close_callback(),document.body.removeEventListener("click",this.remove_bind));this.element=null}};d.remove_bind=d.remove.bind(d);d.show=function(a,b){this.remove();"function"==typeof b&&(this.close_callback=b);document.body.addEventListener("click",this.remove_bind);(b=document.getElementById("root_ctx_menu"))&&b.parentNode.removeChild(b);c(document.body).append('<ul class="jsroot_ctxmenu">'+this.code+"</ul>");
this.element=c(".jsroot_ctxmenu");var f=this;this.element.attr("id","root_ctx_menu").css("left",a.clientX+window.pageXOffset).css("top",a.clientY+window.pageYOffset).css("position","absolute").menu({items:"> :not(.ui-widget-header)",select:function(a,b){a=b.item.attr("arg");b=(b=b.item.attr("cnt"))?f.funcs[b]:null;f.remove();"function"==typeof b&&("painter"in d?b.bind(f.painter)(a):b(a))}});var e=b=null;a.clientX+this.element.width()>c(window).width()&&(b=c(window).width()-this.element.width()-20);
a.clientY+this.element.height()>c(window).height()&&(e=c(window).height()-this.element.height()-20);null!==b&&this.element.css("left",(0<b?b:0)+window.pageXOffset);null!==e&&this.element.css("top",(0<e?e:0)+window.pageYOffset)};h.CallBack(b,d);return d};k=h.BrowserLayout;k.prototype.SetBrowserTitle=function(a){var b=l.select("#"+this.gui_div+" .jsroot_browser");b.empty()||b.select(".jsroot_browser_title").text(a)};k.prototype.ToggleBrowserKind=function(a){if(this.gui_div){if(!a){if(!this.browser_kind)return;
a="float"===this.browser_kind?"fix":"float"}var b=l.select("#"+this.gui_div+" .jsroot_browser"),d=c(b.node()).find(".jsroot_browser_area"),f=this;"float"===this.browser_kind?d.css("bottom","0px").css("top","0px").css("width","").css("height","").toggleClass("jsroot_float_browser",!1).resizable("destroy").draggable("destroy"):"fix"===this.browser_kind&&(b.select(".jsroot_v_separator").remove(),d.css("left","0px"),l.select("#"+this.gui_div+"_drawing").style("left","0px"),b.select(".jsroot_h_separator").style("left",
"0px"),l.select("#"+this.gui_div+"_status").style("left","0px"),f.CheckResize());this.browser_kind=a;this.browser_visible=!0;"float"===a?(d.css("bottom","40px").toggleClass("jsroot_float_browser",!0).resizable({containment:"parent",minWidth:100,resize:function(a,b){f.SetButtonsPosition()},stop:function(a,b){7>c(this).parent().innerHeight()-b.position.top-b.size.height&&c(this).css("height","").css("bottom",0)}}).draggable({containment:"parent",handle:c("#"+this.gui_div).find(".jsroot_browser_title"),
snap:!0,snapMode:"inner",snapTolerance:10,drag:function(a,b){f.SetButtonsPosition()},stop:function(a,b){7>c(this).parent().innerHeight()-c(this).offset().top-c(this).outerHeight()&&c(this).css("height","").css("bottom",0)}}),this.AdjustBrowserSize()):(d.css("left",0).css("top",0).css("bottom",0).css("height",""),a=b.append("div").classed("jsroot_separator",!0).classed("jsroot_v_separator",!0).style("position","absolute").style("top",0).style("bottom",0),c(a.node()).draggable({axis:"x",cursor:"ew-resize",
containment:"parent",helper:function(){return c(this).clone().css("background-color","grey")},drag:function(a,b){f.SetButtonsPosition();f.AdjustSeparator(b.position.left,null)},stop:function(a,b){f.CheckResize()}}),this.AdjustSeparator(250,null,!0,!0));this.SetButtonsPosition()}};k.prototype.SetButtonsPosition=function(){if(this.gui_div){var a=c("#"+this.gui_div+" .jsroot_browser"),b=a.find(".jsroot_browser_btns"),d=7,f=7;if(b.length){if(this.browser_visible){f=a.find(".jsroot_browser_area");a=a.offset();
var e=f.offset();d=e.top-a.top+7;f=e.left-a.left+f.innerWidth()-27}b.css("left",f+"px").css("top",d+"px")}}};k.prototype.AdjustBrowserSize=function(a){if(this.gui_div&&"float"===this.browser_kind){var b=c("#"+this.gui_div+" .jsroot_browser");if(b.length){var d=b.find(".jsroot_browser_area"),f=b.find(".jsroot_browser_hierarchy");b=f.children(":first");a?d.parent().innerHeight()-10<d.innerHeight()&&d.css("bottom","0px").css("top","0px"):b.length&&(a=f.innerHeight(),b=b.innerHeight(),void 0!==b&&b<.7*
a&&d.css("bottom",""))}}};k.prototype.ToggleBrowserVisisbility=function(a){if(this.gui_div&&"string"!==typeof this.browser_visible){var b=l.select("#"+this.gui_div+" .jsroot_browser"),d=b.select(".jsroot_browser_area");if(!d.empty()){var f=b.select(".jsroot_v_separator"),e=l.select("#"+this.gui_div+"_drawing"),g=d.property("last_left"),h=d.property("last_vsepar"),q=d.property("last_drawing");if(this.browser_visible)d.property("last_left",d.style("left")),f.empty()||(d.property("last_vsepar",f.style("left")),
d.property("last_drawing",e.style("left"))),g=(-c(d.node()).outerWidth(!0)-10).toString()+"px",h=c(b.node()).outerWidth(!0),f.empty()&&c(d.node()).offset().left>h/2&&(g=h+10+"px"),h="-10px",q="0px";else{if(a)return;d.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}var m=this,p=!this.browser_visible,x=a?0:700;this.browser_visible="changing";d.transition().style("left",g).duration(x).on("end",function(){a||(m.browser_visible=p)&&m.SetButtonsPosition()});p||b.select(".jsroot_browser_btns").transition().style("left",
"7px").style("top","7px").duration(x);f.empty()||(f.transition().style("left",h).duration(x),e.transition().style("left",q).duration(x).on("end",this.CheckResize.bind(this)));this.status_layout&&"fix"==this.browser_kind&&(b.select(".jsroot_h_separator").transition().style("left",q).duration(x),b.select(".jsroot_status_area").transition().style("left",q).duration(x))}}};k.prototype.Toggle=function(a){"changing"!==this.browser_visible&&(a===this.browser_kind?this.ToggleBrowserVisisbility():this.ToggleBrowserKind(a))};
k.prototype.DeleteContent=function(){var a=l.select("#"+this.gui_div+" .jsroot_browser");if(!a.empty()){this.CreateStatusLine("delete");var b=a.select(".jsroot_v_separator");b.empty()||c(b.node()).draggable("destroy");this.ToggleBrowserVisisbility(!0);a.selectAll("*").remove();delete this.browser_visible;delete this.browser_kind;this.CheckResize()}};k.prototype.CreateStatusLine=function(a,b){var d=l.select("#"+this.gui_div+" .jsroot_browser");if(d.empty())return"";var f=this.gui_div+"_status",e=l.select("#"+
f),g=!e.empty();"toggle"===b?b=!g:"delete"===a?(b=!1,a=0,delete this.status_layout):void 0===b&&(b=!0,this.status_layout="app");if(g){if(!0===b||"app"===this.status_layout)return f;d=d.select(".jsroot_h_separator");c(d.node()).draggable("destroy");d.remove();e.remove();delete this.status_layout;this.status_handler&&h.Painter.ShowStatus===this.status_handler&&(delete h.Painter.ShowStatus,delete this.status_handler);this.AdjustSeparator(null,0,!0);return""}if(!1===b)return"";b=l.select("#"+this.gui_div+
"_drawing").style("left");e=d.insert("div",".jsroot_browser_area").attr("id",f).classed("jsroot_status_area",!0).style("position","absolute").style("left",b).style("height","20px").style("bottom",0).style("right",0).style("margin",0).style("border",0);d=d.insert("div",".jsroot_browser_area").classed("jsroot_separator",!0).classed("jsroot_h_separator",!0).style("position","absolute").style("left",b).style("right",0).style("bottom","20px").style("height","5px");var n=this;c(d.node()).draggable({axis:"y",
cursor:"ns-resize",containment:"parent",helper:function(){return c(this).clone().css("background-color","grey")},drag:function(a,b){n.AdjustSeparator(null,-b.position.top)},stop:function(a,b){n.CheckResize()}});a&&"string"!==typeof a||(a=this.last_hsepar_height||20);this.AdjustSeparator(null,a,!0);if("app"==this.status_layout)return f;this.status_layout=new h.GridDisplay(f,"horizx4_1213");a=["object name","object title","mouse coordinates","object info"];for(e=0;4>e;++e)l.select(this.status_layout.GetFrame(e)).attr("title",
a[e]).style("overflow","hidden").append("label").attr("class","jsroot_status_label");this.status_handler=this.ShowStatus.bind(this);h.Painter.ShowStatus=this.status_handler;return f};k.prototype.AdjustSeparator=function(a,b,d,f){if(this.gui_div){var e=l.select("#"+this.gui_div+" .jsroot_browser");null===b&&f&&!e.select(".jsroot_h_separator").empty()&&(b=e.select(".jsroot_h_separator").style("bottom"),b="string"==typeof b&&b.indexOf("px")==b.length-2?b.substr(0,b.length-2):null);if(null!==b){b=parseInt(b);
f=e.select(".jsroot_h_separator");var g=0;f.empty()||(0>b&&(b+=c(e.node()).outerHeight(!0)-5),5>b&&(b=5),this.last_hsepar_height=b,f.style("bottom",b+"px").style("height","5px"),l.select("#"+this.gui_div+"_status").style("height",b+"px"),g=b+5+"px");l.select("#"+this.gui_div+"_drawing").style("bottom",g)}null!==a&&(a=parseInt(a),50>a&&(a=50),e.select(".jsroot_browser_area").style("width",a-5+"px"),l.select("#"+this.gui_div+"_drawing").style("left",a+5+"px"),e.select(".jsroot_h_separator").style("left",
a+5+"px"),l.select("#"+this.gui_div+"_status").style("left",a+5+"px"),e.select(".jsroot_v_separator").style("left",a+"px").style("width","5px"));d&&this.CheckResize()}};k.prototype.ShowStatus=function(a,b,d,f){if(this.status_layout&&(c(this.status_layout.GetFrame(0)).children("label").text(a||""),c(this.status_layout.GetFrame(1)).children("label").text(b||""),c(this.status_layout.GetFrame(2)).children("label").text(f||""),c(this.status_layout.GetFrame(3)).children("label").text(d||""),!this.status_layout.first_check)){this.status_layout.first_check=
!0;for(b=a=0;4>b;++b)a=Math.max(a,c(this.status_layout.GetFrame(b)).children("label").outerHeight());5<a&&(a>this.last_hsepar_height||a<this.last_hsepar_height+5)&&this.AdjustSeparator(null,a,!0)}};k=h.HierarchyPainter;k.prototype.isLastSibling=function(a){if(!a||!a._parent||!a._parent._childs)return!1;var b=a._parent._childs;a=b.indexOf(a);if(0>a)return!1;for(;++a<b.length;)if(!("_hidden"in b[a]))return!1;return!0};k.prototype.addItemHtml=function(a,b,d){if(!a||"_hidden"in a)return!0;var f=a===this.h,
e="_childs"in a,c=h.getDrawHandle(a._kind),n="",q="",m=!1,p=!1,l=this.itemFullName(a);null!==c&&("icon"in c&&(n=c.icon),"icon2"in c&&(q=c.icon2),0==n.length&&"function"==typeof c.icon_get&&(n=c.icon_get(a,this)),"func"in c||"execute"in c||"aslink"in c||"expand"in c&&!1!==a._more)&&(m=!0);"_icon"in a&&(n=a._icon);"_icon2"in a&&(q=a._icon2);0==n.length&&"_online"in a&&(a._icon=n="img_globe");0==n.length&&f&&(a._icon=n="img_base");if(a._more||"_expand"in a||"_player"in a)m=!0;var y=m;y||"string"!=typeof a._kind||
0!=a._kind.indexOf("ROOT.")||(y=m=!0);0==q.length&&(q=n);0==n.length&&(n=e||a._more?"img_folder":"img_page");0==q.length&&(q=e||a._more?"img_folderopen":"img_page");"update"===d?b.selectAll("*").remove():(b=b.append("div"),d&&d>=(a._parent._show_limit||h.gStyle.HierarchyLimit)&&(p=!0));a._d3cont=b.node();b.attr("item",l);for(var k=b.append("div").attr("class","h_line"),u=f?null:a._parent;u&&u!==this.h;)k.insert("div",":first-child").attr("class",this.isLastSibling(u)?"img_empty":"img_line"),u=u._parent;
var r="";u=!1;f||(e&&!p?(r=a._isopen?"img_minus":"img_plus",u=!0):r="img_join");var v=this;if(0<r.length){if(p||this.isLastSibling(a))r+="bottom";r=k.append("div").attr("class",r);if(u)r.style("cursor","pointer").on("click",function(){v.tree_click(this,"plusminus")})}if(this.with_icons&&!p&&(n=a._isopen?q:n,n=0==n.indexOf("img_")?k.append("div").attr("class",n).attr("title",a._kind):k.append("img").attr("src",n).attr("alt","").attr("title",a._kind).style("vertical-align","top").style("width","18px").style("height",
"18px"),"_icon_click"in a||c&&"icon_click"in c))n.on("click",function(){v.tree_click(this,"icon")});c=k.append("a");if(m||e||p)c.attr("class","h_item").on("click",function(){v.tree_click(this)});if(p)return a._break_point=!0,c.attr("title","there are "+(a._parent._childs.length-d)+" more items").text("...more..."),!1;if("disp_kind"in v){h.gStyle.DragAndDrop&&m&&this.enable_dragging(c.node(),l);if(h.gStyle.ContextMenu&&y)c.on("contextmenu",function(){v.tree_contextmenu(this)});c.on("mouseover",function(){v.tree_mouseover(!0,
this)}).on("mouseleave",function(){v.tree_mouseover(!1,this)})}else if(a._direct_context&&h.gStyle.ContextMenu)c.on("contextmenu",function(){v.direct_contextmenu(this)});d=a._name;m="";"_realname"in a&&(d=a._realname);"_title"in a&&(m=a._title);"_fullname"in a&&(m+="  fullname: "+a._fullname);m||(m=d);c.attr("title",m).text(d+("_value"in a?":":"")).style("background",a._background?a._background:null);"_value"in a&&(k=k.append("p"),"_vclass"in a&&k.attr("class",a._vclass),a._isopen||k.html(a._value));
if(e&&(f||a._isopen))for(f=b.append("div").attr("class","h_childs"),e=0;e<a._childs.length&&(b=a._childs[e],b._parent=a,this.addItemHtml(b,f,e));++e);return!0};k.prototype.toggleOpenState=function(a,b){var d=b?b:this.h;if(!("_childs"in d)){if(!a||this.with_icons||!d._expand&&!0!==d._more)return!1;this.expand(this.itemFullName(d));d._childs&&(d._isopen=!0);return!0}if(d!=this.h&&a&&!d._isopen)return d._isopen=!0;for(var f=!1,c=0;c<d._childs.length;++c)this.toggleOpenState(a,d._childs[c])&&(f=!0);if(d!=
this.h&&!a&&d._isopen&&!f)return delete d._isopen,!0;b||this.RefreshHtml();return!1};k.prototype.RefreshHtml=function(a){if(!this.divid)return h.CallBack(a);var b=this.select_main();b.html("").style("overflow","hidden").style("display","flex").style("flex-direction","column");var d=this,f=[],c=null;this.ForEach(function(a){delete a._d3cont;"_fastcmd"in a&&"Command"==a._kind&&f.push(a);"_status"in a&&!c&&(c=a)});if(!this.h||b.empty())return h.CallBack(a);if(f.length)for(var g=b.append("div").attr("class",
"jsroot"),n=0;n<f.length;++n){var q=g.append("button").text("").attr("class","fast_command").attr("item",this.itemFullName(f[n])).attr("title",f[n]._title).on("click",function(){d.ExecuteCommand(l.select(this).attr("item"),this)});"_icon"in f[n]&&q.append("img").attr("src",f[n]._icon)}g=b.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);g.append("a").attr("class","h_button").text("open all").attr("title","open all items in the browser").on("click",d.toggleOpenState.bind(d,
!0));g.append("text").text(" | ");g.append("a").attr("class","h_button").text("close all").attr("title","close all items in the browser").on("click",d.toggleOpenState.bind(d,!1));"function"==typeof d.removeInspector&&(g.append("text").text(" | "),g.append("a").attr("class","h_button").text("remove").attr("title","remove inspector").on("click",d.removeInspector.bind(d)));"_online"in this.h&&(g.append("text").text(" | "),g.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",
d.reload.bind(d)));"disp_kind"in this&&(g.append("text").text(" | "),g.append("a").attr("class","h_button").text("clear").attr("title","clear all drawn objects").on("click",d.clear.bind(d,!1)));b=b.append("div").attr("class","jsroot").style("font-size",this.with_icons?"12px":"15px").style("overflow","auto").style("flex","1");this.background&&b.style("background-color",this.background).style("margin","2px").style("padding","2px");this.addItemHtml(this.h,b.append("div").attr("class","h_tree"));c&&!this.status_disabled&&
null===h.GetUrlOption("nostatus")&&(b=h.findFunction(c._status),(g="function"==typeof b?this.CreateStatusLine():null)&&b(g,this.itemFullName(c)));h.CallBack(a)};k.prototype.UpdateTreeNode=function(a,b){if(void 0===b||b.empty()){b=l.select(a._d3cont?a._d3cont:null);var d=this.itemFullName(a);b.empty()&&(b=this.select_main().select("[item='"+d+"']"));b.empty()&&"_cycle"in a&&(b=this.select_main().select("[item='"+d+";"+a._cycle+"']"));if(b.empty())return}this.addItemHtml(a,b,"update");this.brlayout&&
this.brlayout.AdjustBrowserSize(!0)};k.prototype.UpdateBackground=function(a,b){if(a&&a._d3cont){var d=l.select(a._d3cont);d.empty()||(d=d.select(".h_item"),d.style("background",a._background?a._background:null),b&&a._background&&d.node().scrollIntoView(!1))}};k.prototype.tree_click=function(a,b){if(a){var d=l.select(a.parentNode.parentNode),c=d.attr("item");if(c){var e=this.Find(c);if(e)if(e._break_point){delete e._break_point;this.addItemHtml(e,d,"update");var g=e._parent;e=g._childs.indexOf(e);
d=l.select(d.node().parentNode);if(0>e)return console.error("internal error");g._show_limit=2*(g._show_limit||h.gStyle.HierarchyLimit);for(e+=1;e<g._childs.length&&(c=g._childs[e],c._parent=g,this.addItemHtml(c,d,e));++e);}else{g=e;for(var n=void 0;g&&void 0===(n=g._click_action);)g=g._parent;b&&""!=b||(b="item");var q=h.getDrawSettings(e._kind);g=q.handle;if("icon"==b)c=null,"function"==typeof e._icon_click?c=e._icon_click:g&&"function"==typeof g.icon_click&&(c=g.icon_click),c&&c(e,this)&&this.UpdateTreeNode(e,
d);else{"item"==b&&"_expand"in e&&!l.event.ctrlKey&&!l.event.shiftKey&&(b="plusminus");if("plusminus"==b&&!("_childs"in e)&&e._more||"item"==b&&"expand"===n)return this.expand(c,null,d);if("item"==b){if("_player"in e)return this.player(c);if(g&&g.aslink)return window.open(c+"/");if(g&&g.execute)return this.ExecuteCommand(c,a.parentNode);if(g&&g.ignore_online&&this.isOnlineItem(e))return;a=e._can_draw;b=e._more;n="expand"===this.default_by_click;var m="";l.event.shiftKey&&(m=g&&g.shift?g.shift:"inspect",
"inspect"===m&&g&&g.noinspect&&(m=""));g&&g.ctrl&&l.event.ctrlKey&&(m=g.ctrl);if(!m)for(var p=e._parent;p;p=p._parent)if(p._painter){a=!1;void 0===b&&(b=!1);break}e._childs&&(b=!1);void 0===a&&(a=q.draw);void 0===b&&(b=q.expand);a&&b&&!m&&(n||g&&"expand"===g.dflt?a=!1:this.isItemDisplayed(c)&&(a=!1));if(a)return this.display(c,m);if(b||n)return this.expand(c,null,d);if("string"===typeof e._kind&&0===e._kind.indexOf("ROOT.")&&q.inspect&&!1!==a)return this.display(c,"inspect");if(!e._childs||e===this.h)return}e._isopen?
delete e._isopen:e._isopen=!0;this.UpdateTreeNode(e,d)}}}}};k.prototype.tree_mouseover=function(a,b){b=l.select(b.parentNode.parentNode).attr("item");var c=this.Find(b);if(c){for(var f,e=c;e&&!f;)f=e._painter,e=e._parent;f&&"function"===typeof f.MouseOverHierarchy&&f.MouseOverHierarchy(a,b,c)}};k.prototype.direct_contextmenu=function(a){l.event.preventDefault();var b=l.select(a.parentNode.parentNode).attr("item"),c=this.Find(b);c&&"function"===typeof this.fill_context&&h.Painter.createMenu(this,function(b){b.painter.fill_context(b,
c);0<b.size()&&(b.tree_node=a.parentNode,b.show(l.event))})};k.prototype.tree_contextmenu=function(a){function b(a){var b=document.createElement("div");b.innerHTML='<a href="'+a.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")+'">x</a>';return b.firstChild.href}l.event.preventDefault();var c=l.select(a.parentNode.parentNode).attr("item"),f=this.Find(c);if(f){var e=this,g=e.GetOnlineProp(c),n=e.GetFileProp(c);h.Painter.createMenu(e,function(d){if(""!=c||"_jsonfile"in f)if(g)e.FillOnlineMenu(d,
g,c);else{var m=h.getDrawSettings(f._kind,"nosame");f._can_draw&&(m.opts||(m.opts=[""]),0>m.opts.indexOf("")&&m.opts.unshift(""));m.opts&&d.addDrawMenu("Draw",m.opts,function(a){this.display(c,a)});if(n&&m.opts&&!n.localfile){var p=b(n.fileurl);0==p.indexOf(h.source_dir)&&(p=p.slice(h.source_dir.length));p=n.kind+"="+p;if(0<n.itemname.length){var q=n.itemname;0<=q.search(/\+| |,/)&&(q="'"+q+"'");p+="&item="+q}d.addDrawMenu("Draw in new tab",m.opts,function(a){window.open(h.source_dir+"index.htm?nobrowser&"+
p+"&opt="+a)})}!m.expand||"_childs"in f||!f._more&&"_more"in f||d.add("Expand",function(){e.expand(c)});"ROOT.TStyle"===f._kind&&d.add("Apply",function(){e.ApplyStyle(c)})}else{m=function(){return 0<r++?"&":"?"};var k="",r=0,u=[];e.ForEachRootFile(function(a){u.push(a._file.fFullURL)});e.GetTopOnlineItem()||(k=h.source_dir+"index.htm");e.IsMonitoring()&&(k+=m()+"monitoring="+e.MonitoringInterval());1==u.length?k+=m()+"file="+u[0]:1<u.length&&(k+=m()+"files="+JSON.stringify(u));e.disp_kind&&(k+=m()+
"layout="+e.disp_kind.replace(/ /g,""));var t=[];e.disp&&e.disp.ForEachPainter(function(a){null!=a.GetItemName()&&t.push(a.GetItemName())});1==t.length?k+=m()+"item="+t[0]:1<t.length&&(k+=m()+"items="+JSON.stringify(t));d.add("Direct link",function(){window.open(k)});d.add("Only items",function(){window.open(k+"&nobrowser")})}"function"==typeof f._menu&&f._menu(d,f,e);0<d.size()&&(d.tree_node=a.parentNode,d.separ&&d.add("separator"),d.add("Close"),d.show(l.event))});return!1}};k.prototype.CreateDisplay=
function(a){if("disp"in this){if(0<this.disp.NumDraw())return h.CallBack(a,this.disp);this.disp.Reset();delete this.disp}if(null==document.getElementById(this.disp_frameid))return h.CallBack(a,null);"tabs"==this.disp_kind?this.disp=new t(this.disp_frameid):0==this.disp_kind.indexOf("flex")?this.disp=new w(this.disp_frameid):0==this.disp_kind.indexOf("coll")?this.disp=new r(this.disp_frameid):this.disp=new h.GridDisplay(this.disp_frameid,this.disp_kind);this.disp&&(this.disp.CleanupFrame=this.CleanupFrame.bind(this));
h.CallBack(a,this.disp)};k.prototype.enable_dragging=function(a,b){c(a).draggable({revert:"invalid",appendTo:"body",helper:"clone"})};k.prototype.enable_dropping=function(a,b){var d=this;c(a).droppable({hoverClass:"ui-state-active",accept:function(a){a=a.parent().parent().attr("item");return a!=b&&a?(a=d.Find(a))&&"_kind"in a?0==a._kind.indexOf("ROOT."):!1:!1},drop:function(a,b){return(a=b.draggable.parent().parent().attr("item"))?d.dropitem(a,c(this).attr("id")):!1}})};k.prototype.CreateBrowser=
function(a,b,d){if(!this.gui_div||this.exclude_browser||!this.brlayout)return!1;var f=l.select("#"+this.gui_div+" .jsroot_browser"),e=c(f.node());if(f.empty())return!1;"float"===a&&this.float_browser_disabled&&(a="fix");if(!f.select(".jsroot_browser_area").empty())return b&&this.brlayout.Toggle(a),h.CallBack(d),!0;var g="<p class='jsroot_browser_version'><a href='https://root.cern/js/'>JSROOT</a> version <span style='color:green'><b>"+h.version+"</b></span></p>";if(this.is_online)g+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:flex;flex-direction:row;"><label style="margin-right:5px; vertical-align:middle;"><input style="vertical-align:middle;" type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>';
else if(this.no_select)"file"==this.no_select&&(g+='<div style="display:flex;flex-direction:row">');else{var n=l.select("#"+this.gui_div),q=n.attr("files")||"../files/hsimple.root";n=h.GetUrlOption("path")||n.attr("path")||"";q=q.split(";");g+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>';
for(var m in q)g+='<option value = "'+n+q[m]+'">'+q[m]+"</option>";g+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px;"       class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px;"       class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}if(this.is_online||
!this.no_select||"file"==this.no_select)g+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>';g+='<div id="'+this.gui_div+'_browser_hierarchy" class="jsroot_browser_hierarchy"></div>';this.brlayout.SetBrowserContent(g);this.brlayout.SetBrowserTitle(this.is_online?"ROOT online server":"Read a ROOT file");var p=this,k=null;this.is_online||this.no_select||(this.ReadSelectedFile=function(){var a=f.select(".gui_urlToLoad").property("value").trim();a&&
(a.toLowerCase().lastIndexOf(".json")==a.length-5?this.OpenJsonFile(a):this.OpenRootFile(a))},e.find(".gui_selectFileName").val("").change(function(){e.find(".gui_urlToLoad").val(c(this).val())}),e.find(".gui_fileBtn").button().click(function(){e.find(".gui_localFile").click()}),e.find(".gui_ReadFileBtn").button().click(function(){p.ReadSelectedFile()}),e.find(".gui_ResetUIBtn").button().click(function(){p.clear(!0)}),e.find(".gui_urlToLoad").keyup(function(a){13==a.keyCode&&p.ReadSelectedFile()}),
e.find(".gui_localFile").change(function(a){a=a.target.files;for(var b=0;b<a.length;++b){var c=a[b];f.select(".gui_urlToLoad").property("value",c.name);p&&p.OpenRootFile(c,k)}k=null}),this.SelectLocalFile=function(a){k=a;c("#"+this.gui_div+" .jsroot_browser").find(".gui_localFile").click()});g=e.find(".gui_layout");if(g.length){m="simple;vert2;vert3;vert231;horiz2;horiz32;flex;grid 2x2;grid 1x3;grid 2x3;grid 3x3;grid 4x4;collapsible;tabs".split(";");for(q=0;q<m.length;++q)n=document.createElement("option"),
n.value=m[q],n.innerHTML=m[q],g.get(0).appendChild(n);g.change(function(){p.SetDisplay(c(this).val()||"collapsible",p.gui_div+"_drawing")})}this.SetDivId(this.gui_div+"_browser_hierarchy");b&&(this.RefreshHtml(),this.InitializeBrowser());this.brlayout.ToggleBrowserKind(a||"fix");h.CallBack(d);return!0};k.prototype.InitializeBrowser=function(){var a=l.select("#"+this.gui_div+" .jsroot_browser");if(!a.empty()&&this.brlayout){var b=c(a.node()),d=this;this.brlayout&&this.brlayout.AdjustBrowserSize();
if(a=a.select(".gui_layout").node()){var f=!1;for(g in a.options){var e=a.options[g].text;if("string"===typeof e&&(e==this.GetLayout()||e.replace(/ /g,"")==this.GetLayout())){a.selectedIndex=g;f=!0;break}}if(!f){var g=document.createElement("option");g.innerHTML=g.value=this.GetLayout();a.appendChild(g);a.selectedIndex=a.options.length-1}}if(this.is_online)this.h&&this.h._toptitle&&this.brlayout.SetBrowserTitle(this.h._toptitle),b.find(".gui_monitoring").prop("checked",this.IsMonitoring()).click(function(){d.EnableMonitoring(this.checked);
d.updateAll(!this.checked)});else if(!this.no_select){var h="";this.ForEachRootFile(function(a){h||(h=a._fullurl)});b.find(".gui_urlToLoad").val(h)}}};k.prototype.EnableMonitoring=function(a){this.SetMonitoring(void 0,a);var b=l.select("#"+this.gui_div+" .jsroot_browser .gui_monitoring");b.empty()||b.property("checked")===a||b.property("checked",a)};k.prototype.CreateStatusLine=function(a,b){return!this.status_disabled&&this.gui_div&&this.brlayout?this.brlayout.CreateStatusLine(a,b):""};h.BuildGUI=
function(){var a=l.select("#simpleGUI"),b=!1;if(a.empty()){a=l.select("#onlineGUI");if(a.empty())return alert("no div for gui found");b=!0}"true"===a.attr("ignoreurl")&&(h.gStyle.IgnoreUrlOptions=!0);if(null!==h.GetUrlOption("nobrowser")||a.attr("nobrowser")&&"false"!==a.attr("nobrowser"))return h.BuildNobrowserGUI();h.Painter.readStyleFromURL();var c=new h.HierarchyPainter("root",null);c.is_online=b;c.StartGUI(a,c.InitializeBrowser.bind(c))};r.prototype=Object.create(h.MDIDisplay.prototype);r.prototype.ForEachFrame=
function(a,b){var d=this.frameid+"_collapsible";null!=document.getElementById(d)&&"function"==typeof a&&c("#"+d+" .collapsible_draw").each(function(){b&&c(this).is(":hidden")||a(c(this).get(0))})};r.prototype.GetActiveFrame=function(){var a=h.MDIDisplay.prototype.GetActiveFrame.call(this);if(a&&!c(a).is(":hidden"))return a;a=null;this.ForEachFrame(function(b){a||(a=b)},!0);return a};r.prototype.ActivateFrame=function(a){c(a).is(":hidden")&&c(a).prev().toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideDown(0);
c(a).prev()[0].scrollIntoView();this.active_frame_title=l.select(a).attr("frame_title")};r.prototype.CreateFrame=function(a){this.BeforeCreateFrame(a);var b=this.frameid+"_collapsible";null==document.getElementById(b)&&c("#"+this.frameid).append('<div id="'+b+'" class="jsroot ui-accordion ui-accordion-icons ui-widget ui-helper-reset" style="overflow:auto; overflow-y:scroll; height:100%; padding-left: 2px; padding-right: 2px"></div>');var d=this,f=b+"_sub"+this.cnt++,e=f+"h",g='<h5 id="'+e+"\"><span class='ui-icon ui-icon-triangle-1-e'></span><a> "+
a+"</a>&nbsp; <button type='button' class='jsroot_collaps_closebtn' style='float:right; width:1.4em' title='close canvas'/> </h5>\n<div class='collapsible_draw' id='"+f+"'></div>\n";c("#"+b).append(g);c("#"+e).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){c(this).toggleClass("ui-state-hover")}).click(function(){c(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);
var a=c(this).next(),b=a.is(":hidden");a.css("display",b?"none":"");b||h.resize(a.get(0))}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();c("#"+e).find(" .jsroot_collaps_closebtn").button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){d.CleanupFrame(c(this).parent().next().attr("id"));c(this).parent().next().remove();c(this).parent().remove()});c("#"+e).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);
return c("#"+f).attr("frame_title",a).css("overflow","hidden").attr("can_resize","height").css("position","relative").get(0)};t.prototype=Object.create(h.MDIDisplay.prototype);t.prototype.ForEachFrame=function(a,b){var d=this.frameid+"_tabs";if(null!=document.getElementById(d)&&"function"==typeof a){var f=-1,e=c("#"+d).tabs("option","active");c("#"+d+"> .tabs_draw").each(function(){f++;b&&f!=e||a(c(this).get(0))})}};t.prototype.GetActiveFrame=function(){var a=null;this.ForEachFrame(function(b){a||
(a=b)},!0);return a};t.prototype.ActivateFrame=function(a){var b=0,d=-1;this.ForEachFrame(function(f){c(f).attr("id")==c(a).attr("id")&&(d=b);b++});c("#"+this.frameid+"_tabs").tabs("option","active",d);this.active_frame_title=l.select(a).attr("frame_title")};t.prototype.CreateFrame=function(a){this.BeforeCreateFrame(a);var b=this,d=this.frameid+"_tabs",f=d+"_sub"+this.cnt++,e='<li><a href="#'+f+'">'+a+'</a><span class="ui-icon ui-icon-close" style="float: left; margin: 0.4em 0.2em 0 0; cursor: pointer;" role="presentation">Remove Tab</span></li>',
g='<div class="tabs_draw" id="'+f+'"></div>';if(null==document.getElementById(d)){c("#"+this.frameid).append('<div id="'+d+'" class="jsroot"> <ul>'+e+" </ul>"+g+"</div>");var n=c("#"+d).css("overflow","hidden").tabs({heightStyle:"fill",activate:function(a,b){c(b.newPanel).css("overflow","hidden");h.resize(c(b.newPanel).get(0))}});n.delegate("span.ui-icon-close","click",function(){var a=c(this).closest("li").remove().attr("aria-controls");b.CleanupFrame(a);c("#"+a).remove();n.tabs("refresh");0==c("#"+
d+"> .tabs_draw").length&&c("#"+d).remove()})}else c("#"+d).find("> .ui-tabs-nav").append(e),c("#"+d).append(g),c("#"+d).tabs("refresh"),c("#"+d).tabs("option","active",-1);c("#"+f).empty().css("overflow","hidden").attr("frame_title",a);return c("#"+f).get(0)};t.prototype.CheckMDIResize=function(a,b){c("#"+this.frameid+"_tabs").tabs("refresh");h.MDIDisplay.prototype.CheckMDIResize.call(this,a,b)};w.prototype=Object.create(h.MDIDisplay.prototype);w.prototype.ForEachFrame=function(a,b){var d=this.frameid+
"_flex";null!=document.getElementById(d)&&"function"==typeof a&&c("#"+d+" .flex_draw").each(function(){b&&c(this).is(":hidden")||a(c(this).get(0))})};w.prototype.GetActiveFrame=function(){var a=h.MDIDisplay.prototype.GetActiveFrame.call(this);if(a&&!c(a).is(":hidden"))return a;a=null;this.ForEachFrame(function(b){a||(a=b)},!0);return a};w.prototype.ActivateFrame=function(a){this.active_frame_title=l.select(a).attr("frame_title")};w.prototype.CreateFrame=function(a){function b(a){if("first"===a&&(a=
null,c("#"+f+" .flex_frame").each(function(){c(this).is(":hidden")||"minimal"==c(this).prop("state")||(a=c(this))}),!a))return;a.appendTo(a.parent());if("minimal"!=a.prop("state")){a=a.find(".flex_draw").get(0);var b=new h.TObjectPainter;b.SetDivId(a,-1);h.Painter.SelectActivePad({pp:b.canv_painter(),active:!0});h.resize(a)}}function d(a,c){var d=a.prop("state");d||(d="normal");a.prop("state",c);if(c!=d){"normal"==d&&(a.prop("original_height",a.height()),a.prop("original_width",a.width()),a.prop("original_top",
a.css("top")),a.prop("original_left",a.css("left")));a.find(".jsroot_minbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-s","minimal"!=c).toggleClass("ui-icon-triangle-2-n-s","minimal"==c);a.find(".jsroot_maxbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-n","maximal"!=c).toggleClass("ui-icon-triangle-2-n-s","maximal"==c);switch(c){case "minimal":a.height(a.find(".flex_header").height()).width("auto");a.find(".flex_draw").css("display","none");a.find(".ui-resizable-handle").css("display",
"none");break;case "maximal":a.height("100%").width("100%").css("left","").css("top","");a.find(".flex_draw").css("display","");a.find(".ui-resizable-handle").css("display","none");break;default:a.find(".flex_draw").css("display",""),a.find(".ui-resizable-handle").css("display",""),a.height(a.prop("original_height")).width(a.prop("original_width")),"minimal"!=d&&a.css("left",a.prop("original_left")).css("top",a.prop("original_top"))}"minimal"!==c?b(a):b("first")}}this.BeforeCreateFrame(a);var f=this.frameid+
"_flex";null==document.getElementById(f)&&c("#"+this.frameid).append('<div id="'+f+'" class="jsroot" style="overflow:none; height:100%; width:100%"></div>');var e=this,g=c("#"+f),n=g.width(),k=g.height(),m=f+"_frame"+this.cnt;g.append('<div id="'+m+'" class="flex_frame" style="position:absolute"><div class="ui-widget-header flex_header"><p>'+a+'</p><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/></div><div id="'+
m+'_cont" class="flex_draw"></div></div>');c("#"+m).css("left",parseInt(this.cnt%5*n/10)).css("top",parseInt(this.cnt%5*k/10)).width(Math.round(.58*n)).height(Math.round(.58*k)).resizable({helper:"jsroot-flex-resizable-helper",start:function(a,d){b(c(this))},stop:function(a,b){a={width:b.size.width-1,height:b.size.height-c(this).find(".flex_header").height()-1};h.resize(c(this).find(".flex_draw").get(0),a)}}).draggable({containment:"parent",start:function(a,d){b(c(this));var e=c(this).find(".flex_draw");
a=document.elementFromPoint(a.clientX,a.clientY);var f=!1;c(a).parents().map(function(){c(this).get(0)===e.get(0)&&(f=!0)});if(f)return!1}}).click(function(){b(c(this))}).find(".flex_header").click(function(){b(c(this).parent())}).dblclick(function(){var a=c(this).parent();"normal"==a.prop("state")?d(a,"maximal"):d(a,"normal")}).find("button").first().attr("title","close canvas").button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){var a=c(this).parent().parent();e.CleanupFrame(a.find(".flex_draw").get(0));
a.remove();b("first")}).next().attr("title","maximize canvas").addClass("jsroot_maxbutton").button({icons:{primary:"ui-icon-triangle-1-n"},text:!1}).click(function(){var a=c(this).parent().parent(),b=c(this).find(".ui-icon").hasClass("ui-icon-triangle-1-n");d(a,b?"maximal":"normal")}).next().attr("title","minimize canvas").addClass("jsroot_minbutton").button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).click(function(){var a=c(this).parent().parent(),b=c(this).find(".ui-icon").hasClass("ui-icon-triangle-1-s");
d(a,b?"minimal":"normal")});c("#"+m).find(".ui-resizable-handle").css("z-index","");this.cnt++;return c("#"+m+"_cont").attr("frame_title",a).get(0)};h.GridDisplay.prototype.CreateSeparator=function(a,b,d){b=c(b.append("div").node());b.toggleClass("jsroot_separator",!0).toggleClass(a.vertical?"jsroot_hline":"jsroot_vline",!0).prop("handle",a).attr("separator-id",d.id).css("position","absolute").css(a.vertical?"top":"left","calc("+d.position+"% - 2px)").css(a.vertical?"width":"height",(a.size||100)+
"%").css(a.vertical?"height":"width","5px").css("cursor",a.vertical?"ns-resize":"ew-resize");b.bind("changePosition",function(a,b){function d(a,b){var c=e.vertical?"height":"width",d=e.groups[b].size+"%";a.children("[groupid='"+b+"']").css(c,d).children(".jsroot_separator").css(c,d)}var e=c(this).prop("handle");a=parseInt(c(this).attr("separator-id"));var f=e.groups[a].position;"restore"===b?f=e.groups[a].position0:b&&b.offset&&(f=e.vertical?Math.round((b.offset.top+2-c(this).parent().offset().top)/
c(this).parent().innerHeight()*100):Math.round((b.offset.left+2-c(this).parent().offset().left)/c(this).parent().innerWidth()*100));var h=e.groups[a].position-f;.3>Math.abs(h)||5>Math.min(e.groups[a-1].size-h,e.groups[a].size+h)||(e.groups[a-1].size-=h,e.groups[a].size+=h,e.groups[a].position=f,c(this).css(e.vertical?"top":"left","calc("+f+"% - 2px)"),d(c(this).parent(),a-1),d(c(this).parent(),a),"restore"===b&&(c(this).trigger("resizeGroup",a-1),c(this).trigger("resizeGroup",a)))});b.bind("resizeGroup",
function(a,b){a=c(this).parent().children("[groupid='"+b+"']");a.hasClass("jsroot_newgrid")||(a=a.find(".jsroot_newgrid"));a.each(function(){h.resize(c(this).get(0))})});b.dblclick(function(){c(this).trigger("changePosition","restore")});b.draggable({axis:a.vertical?"y":"x",cursor:a.vertical?"ns-resize":"ew-resize",containment:"parent",helper:function(){return c(this).clone().css("background-color","grey")},start:function(a,b){a=c(this).prop("handle");b=parseInt(c(this).attr("separator-id"));a.groups[b].startpos=
a.groups[b].position},drag:function(a,b){c(this).trigger("changePosition",b)},stop:function(a,b){a=c(this).prop("handle");b=parseInt(c(this).attr("separator-id"));.5>Math.abs(a.groups[b].startpos-a.groups[b].position)||(c(this).trigger("resizeGroup",b-1),c(this).trigger("resizeGroup",b))}})};h.CreateTreePlayer=function(a){a.draw_first=!0;a.ConfigureOnline=function(a,c,f,e,g){this.SetItemName(a,"",this);this.url=c;this.root_version=e;this.askey=f;this.dflt_expr=g};a.ConfigureTree=function(a){this.local_tree=
a};a.KeyUp=function(a){13==a.keyCode&&this.PerformDraw()};a.ShowExtraButtons=function(a){var b=c(this.select_main().node());b.find(".treedraw_buttons").append(" Cut: <input class='treedraw_cut ui-corner-all ui-widget' style='width:8em;margin-left:5px' title='cut expression'></input> Opt: <input class='treedraw_opt ui-corner-all ui-widget' style='width:5em;margin-left:5px' title='histogram draw options'></input> Num: <input class='treedraw_number' style='width:7em;margin-left:5px' title='number of entries to process (default all)'></input> First: <input class='treedraw_first' style='width:7em;margin-left:5px' title='first entry to process (default first)'></input> <button class='treedraw_clear' title='Clear drawing'>Clear</button>");
var f=void 0,e=this;this.local_tree&&(f=this.local_tree.fEntries||0);b.find(".treedraw_cut").val(a&&a.parse_cut?a.parse_cut:"").keyup(this.keyup);b.find(".treedraw_opt").val(a&&a.drawopt?a.drawopt:"").keyup(this.keyup);b.find(".treedraw_number").val(a&&a.numentries?a.numentries:"").spinner({numberFormat:"n",min:0,page:1E3,max:f}).keyup(this.keyup);b.find(".treedraw_first").val(a&&a.firstentry?a.firstentry:"").spinner({numberFormat:"n",min:0,page:1E3,max:f}).keyup(this.keyup);b.find(".treedraw_clear").button().click(function(){h.cleanup(e.drawid)})};
a.Show=function(a,d){this.drawid=a+"_draw";this.keyup=this.KeyUp.bind(this);var b=d&&(d.parse_cut||d.numentries||d.firstentry),e=c("#"+a);e.html("<div class='treedraw_buttons' style='padding-left:0.5em'><button class='treedraw_exe' title='Execute draw expression'>Draw</button> Expr:<input class='treedraw_varexp ui-corner-all ui-widget' style='width:12em;margin-left:5px' title='draw expression'></input> "+(b?"":"<button class='treedraw_more'>More</button>")+"</div><hr/><div id='"+this.drawid+"' style='width:100%'></div>");
this.SetDivId(a);var g=this;this.local_tree&&e.find(".treedraw_buttons").attr("title","Tree draw player for: "+this.local_tree.fName);e.find(".treedraw_exe").button().click(function(){g.PerformDraw()});e.find(".treedraw_varexp").val(d&&d.parse_expr?d.parse_expr:this.dflt_expr||"px:py").keyup(this.keyup);b?this.ShowExtraButtons(d):e.find(".treedraw_more").button().click(function(){c(this).remove();g.ShowExtraButtons()});this.CheckResize()};a.PerformLocalDraw=function(){if(this.local_tree){var a=c(this.select_main().node()),
d={expr:a.find(".treedraw_varexp").val()};0==a.find(".treedraw_more").length&&(d.cut=a.find(".treedraw_cut").val(),d.cut||delete d.cut,d.drawopt=a.find(".treedraw_opt").val(),"dump"===d.drawopt&&(d.dump=!0,d.drawopt=""),d.drawopt||delete d.drawopt,d.numentries=parseInt(a.find(".treedraw_number").val()),isNaN(d.numentries)&&delete d.numentries,d.firstentry=parseInt(a.find(".treedraw_first").val()),isNaN(d.firstentry)&&delete d.firstentry);var f=this;d.drawopt&&h.cleanup(f.drawid);f.local_tree.Draw(d,
function(a,b,c){h.redraw(f.drawid,a,b)})}};a.PerformDraw=function(){function a(){h.NewHttpRequest(f,"object",function(a){a&&(h.cleanup(r.drawid),h.draw(r.drawid,a,k))}).send()}if(this.local_tree)return this.PerformLocalDraw();var d=c(this.select_main().node()),f=this.url+"/exe.json.gz?compact=3&method=Draw",e=d.find(".treedraw_varexp").val(),g="h_tree_draw",k="",l=e.indexOf(">>");0>l?e+=">>"+g:(g=e.substr(l+2),"+"==g[0]&&(g=g.substr(1)),l=g.indexOf("("),0<l&&(g=g.substr(0,l)));if(0==d.find(".treedraw_more").length){l=
d.find(".treedraw_cut").val();var m=d.find(".treedraw_number").val(),p=d.find(".treedraw_first").val();k=d.find(".treedraw_opt").val();f+='&prototype="const char*,const char*,Option_t*,Long64_t,Long64_t"&varexp="'+e+'"&selection="'+l+'"';""==m&&(m=394499<=this.root_version?"TTree::kMaxEntries":"1000000000");""==p&&(p="0");f+='&option="'+k+'"&nentries='+m+"&firstentry="+p}else f+='&prototype="Option_t*"&opt="'+e+'"';f+="&_ret_object_="+g;var r=this;this.askey?(this.askey=!1,h.NewHttpRequest(this.url+
"/root.json","text",a).send()):a()};a.CheckResize=function(a){var b=c(this.select_main().node());c("#"+this.drawid).width(b.width());a=b.height();var f=b.find(".treedraw_buttons").outerHeight(!0);b=b.find("hr").outerHeight(!0);c("#"+this.drawid).height(a-f-b-2);h.resize(this.drawid)};return a};h.drawTreePlayer=function(a,b,c,f){var d=a.Find(b),g=a.GetTopOnlineItem(d),k="",q=0;if(!d||!g)return null;if(f){for(k=d._name;d&&!d._ttree;)d=d._parent;if(!d)return null;b=a.itemFullName(d)}var m=a.GetOnlineItemUrl(b);
if(!m)return null;g=g._root_version?parseInt(g._root_version):396545;a=a.GetDisplay();if(!a)return null;a=a.FindFrame(b,!0);if(!a)return null;a=l.select(a).attr("id");var p=new h.TBasePainter;if(d._childs&&!f)for(f=0;f<d._childs.length;++f){var r=d._childs[f];r&&r._kind&&0==r._kind.indexOf("ROOT.TLeaf")&&2>q&&(0<q++&&(k+=":"),k+=r._name)}h.CreateTreePlayer(p);p.ConfigureOnline(b,m,c,g,k);p.Show(a);return p};h.drawTreePlayerKey=function(a,b){return h.drawTreePlayer(a,b,!0)};h.drawLeafPlayer=function(a,
b){return h.drawTreePlayer(a,b,!1,!0)};h.Painter.ConfigureVSeparator=function(a){};h.Painter.AdjustLayout=function(a,b,c){h.hpainter&&h.hpainter.brlayout&&h.hpainter.brlayout.AdjustSeparator(a,b,!0)};h.Painter.ConfigureHSeparator=function(a){return h.hpainter?h.hpainter.CreateStatusLine(a):""};return h});
